name: Deploy Backend to Render

on:
  push:
    branches:
      - main
    paths:
      - 'server.js'     # Chá»‰ cháº¡y khi sá»­a code Backend
      - 'package.json'  # Hoáº·c cÃ i thÃªm thÆ° viá»‡n
      - '.github/workflows/deploy-backend.yml'

jobs:
  test-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Láº¥y code vá»
        uses: actions/checkout@v4

      - name: ğŸŸ¢ CÃ i Ä‘áº·t Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'

      - name: ğŸ“¦ CÃ i Ä‘áº·t thÆ° viá»‡n (Backend)
        run: npm install

      - name: ğŸ§ª Cháº¡y Test (Giáº£ láº­p)
        run: |
          echo "Äang cháº¡y test Backend..."
          # á» dá»± Ã¡n tháº­t, báº¡n sáº½ cháº¡y: npm test
          echo "Test Backend thÃ nh cÃ´ng!"

      - name: ğŸš€ KÃ­ch hoáº¡t Deploy trÃªn Render
        # Chá»‰ cháº¡y bÆ°á»›c nÃ y náº¿u cÃ¡c bÆ°á»›c trÃªn khÃ´ng lá»—i
        if: success() 
        run: curl "${{ secrets.RENDER_BACKEND_HOOK }}"